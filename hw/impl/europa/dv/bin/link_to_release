#!/usr/bin/env bash

set -e

#--------------------------------------------------------------
# functions
#--------------------------------------------------------------
error() {
  >&2 echo "ERROR: $@"
  exit 1
}

cd $(dirname $0)
source info.txt

[ -d "$REPO_ROOT" ] || error "REPO_ROOT is not defined"

src_dir="$(echo $testbench_dir/build_*/compile_vsim)"
dst_dir="$(echo $src_dir | sed "s#$PWD/europa/#$REPO_ROOT/#")"

# if compile_vsim is symlink: remove symlink; else: remove directory
[ -L "$dst_dir" ] && rm "$dst_dir" || rm -rf "$dst_dir"

# create build_ dir, link compile_vsim dir
mkdir -p "$(dirname "$dst_dir")"
ln -sf "$src_dir" "$dst_dir"
