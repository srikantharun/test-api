---
title: Ahb
doc:
  status: draft
  version: [0, 0, 0]
  confidentiality: internal
---

# AHB package

## AHB manager
The AHB manager IP takes a transaction request as input and generates the corresponging AHB transaction as an output.
The current version won't perform pipelined AHB transactions.
### AHB interface
- HREADY towards subordinate and manager is generated by the "Read data and response multiplexor" depending on the selected subordinate. Each subordinate generates one HREADYOUT which is send to the multiplexor. If only one subordinate is present, HREADY = HREADYOUT.
- HSEL toards subordinate is generated by the external address decoder, hence it is not part of the manager signals. It should be a combinatorial decoding of HADDR.
### Request interface
| Port | Description |
|------|------|
| i_req | Transaction request, when this signal is asserted i_wr, i_addr and i_wdata must be valid |
| i_wr | Inidicates if the transaction request is a write (1) or a read (0) |
| i_addr | Transaction request address |
| i_wdata | Transaction request write data |
| o_rdata | Read data from subordinate |
| o_error | Error response from subordinate |
| o_ready | Master is ready to send a new transaction. When 0, i_req is ignored |

The following is an example of a read transaction:

<script type="WaveDrom">
{signal: [
  {name: 'i_clk', wave: 'p.........'},
  {name: 'i_req', wave: '010.......'},
  {name: 'i_wr' , wave: 'x0x.......'},
  {name: 'i_addr', wave: 'x3x.......', data: ['A', 'ADDR', 'DATA', 'IDLE']},
  {name: 'state', wave: '2.22....2.', data: ['IDLE', 'ADDR', 'DATA', 'IDLE']},
  {name: 'o_ahb_m_haddr', wave: 'x.3.......', data: ['A']},
  {name: 'o_ahb_m_htrans', wave: '2.22......', data: ['IDLE', 'NONSEQ', 'IDLE']},
  {name: 'o_ahb_m_hwrite', wave: 'x.0.......'},
  {name: 'o_ahb_dec_hsel', wave: '0.1.......'},
  {name: 'i_ahb_m_hready', wave: '0......1..'},
  {name: 'i_ahb_m_hrdata', wave: 'x......2..', data: ['Rdata']},
  {name: 'o_rdata', wave: 'x.......2.', data: ['Rdata']},
  {name: 'o_ready', wave: '1.0.....1.'},
  ], config: { hscale: 2 }
}
</script>

## AHB demux

This IP allows a single manager to be connected to multiple subordinates.
It doesn't perform decoding of the subordinate address, so an external decoder is required. The external decoder should perform a combinatorial decoding of paddr.

## AHB mux
This IP allows multiple managers to be connected to a single subordinate port.
Arbitration is static, the manager with higher index has higher priority.
Incoming transactions from managers are always stalled by 1 cycle at the beginning, this simplifies arbitration.
